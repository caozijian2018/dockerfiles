webpackJsonp([10],{M9kK:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"",""])},MC1H:function(e,t,a){var n=a("M9kK");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("7d7e7dd8",n,!1)},PxDy:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("//Fk"),i=a.n(n),r=a("fsHh"),o=a("hlVY"),c=a("eey7"),l={components:{appList:r.a,datePicker:c.a,timeZone:o.a},data:function(){return{loading:!1,downloadLoading:!1,dimensions_str:["appKey"],list:[],app_id:"",total:0,appName:"",tracker:!1,timezone:localStorage.timezone,campaign:!1,adgroup:!1,keyword:"",table_height:innerHeight-300,search_time:"",page_size:12,page:1,filter_arr:[{name:"trackerKey",value:!1},{name:"campaign",value:!1},{name:"adgroup",value:!1},{name:"creative",value:!1},{name:"c1",value:!1},{name:"c2",value:!1},{name:"c3",value:!1},{name:"c4",value:!1},{name:"c5",value:!1},{name:"c6",value:!1}]}},computed:{full_start_time:function(){return this.search_time[0]+this.timezone},full_end_time:function(){return this.search_time[1]+this.timezone}},methods:{formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},handleDownload:function(e){var t=this;this.downloadLoading=!0,i.a.resolve().then(function(){return a("zWO4")}).then(function(a){var n=["click","unique Click","leads","CVR","revenue","channel Leads","channel CVR","payout","profit","ECPM","channel Always","unique Leads"],i=["click_count","unique_click_count","postback_count","conversion","revenue","notify_campaign_count","channel_cvr","payout","profit","ecpm","notify_count","unique_postback_count"];t.dimensions_str=["appKey"];var r=["app"],o=["app_name"];for(var c in t.filter_arr)t.filter_arr[c].value&&(r.push(t.changeLabel(t.filter_arr[c].name)),o.push(t.changeItem(t.filter_arr[c].name)));n=r.concat(n),i=o.concat(i);String(t.dimensions_str);var l=e.data.content.map(function(e){return e.event}),s=t.formatJson(i,l);a.export_json_to_excel({header:n,data:s,filename:"统计"+(new Date).toLocaleString()}),t.downloadLoading=!1})},getSummaries:function(e){var t=e.columns,a=e.data,n=[];return t.forEach(function(e,t){if(0!==t){var i=a.map(function(t){if(!e.property)return"N/A";var a=e.property.split(".");return Number(t[a[0]][a[1]])});if(i.every(function(e){return isNaN(e)}))n[t]="N/A";else switch(n[t]=i.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0),e.property.split(".")[1]){case"click_count":case"unique_click_count":case"postback_count":case"notify_campaign_count":case"notify_count":case"unique_postback_count":n[t]=n[t].toFixed(0);break;case"ecpm":n[t]="N/A";break;case"revenue":case"payout":case"profit":n[t]=n[t].toFixed(3)}}else n[t]="Total"}),n},sortListByCVR:function(e,t){return parseFloat(e.event.conversion)-parseFloat(t.event.conversion)},sortListBychannel_cvr:function(e,t){return parseFloat(e.event.channel_cvr)-parseFloat(t.event.channel_cvr)},getCVR:function(e){return-1==e?"":(100*e).toFixed(2)+"%"},changeItem:function(e){return"appKey"==e?"app_name":"trackerKey"==e?"tracker_name":e},changeLabel:function(e){return"appKey"==e?"app":"trackerKey"==e?"tracker":e},clear:function(){this.app_id="",this.keyword="",this.search_time="",this.filter_arr=[{name:"trackerKey",value:!1},{name:"campaign",value:!1},{name:"adgroup",value:!1},{name:"creative",value:!1},{name:"c1",value:!1},{name:"c2",value:!1},{name:"c3",value:!1},{name:"c4",value:!1},{name:"c5",value:!1},{name:"c6",value:!1}],this.list=[]},SizeChange:function(e){this.page=1,this.page_size=e,this.search()},pageChange:function(e){this.page=e,this.search()},choseTime:function(e){this.timezone=e},dateChange:function(e){this.search_time=e},search:function(e){var t=this;if(this.search_time){for(var a in this.dimensions_str=["appKey"],this.filter_arr)this.filter_arr[a].value&&this.dimensions_str.push(this.filter_arr[a].name);var n=String(this.dimensions_str);e||(this.loading=!0),this.$request_any("data_statistics","get",{search:this.keyword,begin:this.full_start_time,end:this.full_end_time,app_key:this.app_id,page:this.page,capacity:e?1e7:this.page_size,dimensions:n},"v2").then(function(a){var n=0,i=0,r=0,o=0,c=0,l=0,s=0,u=0,p=0;for(var _ in a.data.content){var m=a.data.content[_].event;m.profit=Number((m.revenue-m.payout).toFixed(3)),m.revenue=Number(m.revenue.toFixed(3)),m.payout=Number(m.payout.toFixed(3)),m.conversion=t.getCVR(m.conversion),m.channel_cvr=(m.notify_campaign_count/(0==m.click_count?1:m.click_count)*100).toFixed(2)+"%",m.ecpm=Number((m.revenue/(0==m.click_count?1:m.click_count)).toFixed(3)),n+=m.click_count,i+=m.notify_campaign_count,r+=m.notify_count,o+=m.postback_count,c+=Number(m.revenue),u+=Number(m.payout),l+=m.unique_click_count,s+=m.unique_postback_count,p+=Number(m.profit)}if(e){var v={app_name:"Total",tracker_name:"",campaign:"",adgroup:"",creative:"",appKey:"Total",click_count:n,conversion:"",notify_campaign_count:i,notify_count:r,postback_count:o,repeated_conversion:0,repeated_postback_count:0,revenue:c.toFixed(3),profit:p.toFixed(3),payout:u.toFixed(3),unique_click_count:l,unique_conversion:0,unique_postback_count:s,c1:"",c2:"",c3:"",c4:"",c5:"",c6:""};a.data.content.push({event:v}),t.handleDownload(a)}else t.list=a.data.content,t.total=a.data.total,t.loading=!1})}else this.$msg(this.$t("validate.time"),"error")},seletApp:function(e){this.app_id=e.key,this.appName=e.name}}},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"margin_top_10 padding_left_20 filter-container"},[a("app-list",{staticClass:"filter-item margin_right_20",staticStyle:{width:"200px"},attrs:{"app-id":e.app_id},on:{seletApp:e.seletApp}}),e._v(" "),e._l(e.filter_arr,function(t){return a("el-checkbox",{key:t.name,staticClass:"filter-item",model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[e._v(e._s(e.changeLabel(t.name)))])}),e._v(" "),a("datePicker",{staticClass:"filter-item",attrs:{"search-time":e.search_time},on:{dateChange:e.dateChange}}),e._v(" "),a("time-zone",{staticClass:"filter-item",attrs:{"time-zone":e.timezone},on:{choseTime:e.choseTime}}),e._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"keyword"},nativeOn:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.search()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("el-button",{staticClass:"filter-item margin_left_15",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.search()}}},[e._v(e._s(e.$t("table.search")))]),e._v(" "),a("el-button",{staticClass:"filter-item margin_left_15",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.clear}},[e._v(e._s(e.$t("table.clear")))]),e._v(" "),a("el-button",{staticClass:"filter-item margin_left_15",attrs:{type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:function(t){e.search(!0)}}},[e._v(e._s(e.$t("route.exportExcel")))])],2),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",height:e.table_height,"summary-method":e.getSummaries,"show-summary":""}},[e._l(e.dimensions_str,function(t){return a("el-table-column",{key:t,attrs:{align:"center",label:e.changeLabel(t),width:"140"},scopedSlots:e._u([{key:"default",fn:function(n){return[a("span",[e._v(e._s(String(n.row.event[e.changeItem(t)])))])]}}])})}),e._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"event.click_count",label:"click"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"event.unique_click_count",width:"130",label:"unique Click"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"130",prop:"event.postback_count",sortable:"",label:"leads"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"CVR","sort-method":e.sortListByCVR,sortable:!0,prop:"event.conversion"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"revenue",width:"130",sortable:"",prop:"event.revenue"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"160",sortable:"",prop:"event.notify_campaign_count",label:"channel Leads"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"140",sortable:!0,"sort-method":e.sortListBychannel_cvr,prop:"event.channel_cvr",label:"channel CVR"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"payout",width:"130",sortable:"",prop:"event.payout"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"profit",width:"130",sortable:"",prop:"event.profit"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"120",label:"ECPM",prop:"event.ecpm",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150",label:"channel Always",prop:"event.notify_count",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"150",label:"unique Leads",prop:"event.unique_postback_count",sortable:""}})],2),e._v(" "),a("el-pagination",{staticClass:"text_center margin_top_10",attrs:{"page-sizes":[12,100,300,400,1e3,2e3],background:"",layout:"prev,sizes, pager, next","page-size":e.page_size,total:e.total},on:{"size-change":e.SizeChange,"current-change":e.pageChange}})],1)};s._withStripped=!0;var u={render:s,staticRenderFns:[]},p=u;var _=!1;var m=a("VU/8")(l,p,!1,function(e){_||a("MC1H")},null,null);m.options.__file="src/views/data_statistics_new/index.vue";t.default=m.exports}});